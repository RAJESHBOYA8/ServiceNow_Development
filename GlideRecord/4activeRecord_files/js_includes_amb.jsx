/*! RESOURCE: /scripts/glide-amb-client-bundle.min.js */
!function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=12)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(1));var r=function(e){function n(n){window.console&&console.log(e+" "+n)}return{debug:function(e){"debug"===i.default.logLevel&&n("[DEBUG] "+e)},addInfoMessage:function(e){n("[INFO] "+e)},addErrorMessage:function(e){n("[ERROR] "+e)},addWarnMessage:function(e){n("[WARN] "+e)}}};n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.WEBSOCKET_TYPE_NAME=n.TOKEN_MANAGEMENT_EXTENSION=void 0;n.WEBSOCKET_TYPE_NAME="websocket";n.TOKEN_MANAGEMENT_EXTENSION="tokenManagementExtension";var i={servletPath:"amb",logLevel:"info",loginWindow:"true",wsConnectTimeout:1e4,overlayStyle:"",pruneFailedTransports:"true",subscribeCommandsFlow:{enable:!1,maxInflight:1,maxWait:1e4,retries:3,retryDelay:{min:2e3,max:3e5,increaseFactor:2}},redeliveryDisconnectTimeoutInMins:10,requestHeaderToClearStickySessionCookie:!0};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WS_CONNECTION_NODE_ID=n.TRANSACTION_ALREADY_SUBMITTED=n.REQUEST_SUCCESS=n.REQUEST_ACCEPTED=n.PUBLISH_FAILURE=n.NODEID_COOKIE_KEY=n.MSG_SHARD=n.MSG_NUM=n.MISSING_REQUEST_DATA=n.MISSING_INTERACTION_ID=n.META_HANDSHAKE=n.MESSAGE_REDELIVERY_OPTIONS=n.GLIDE_REMEMBER_ME=n.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC=n.CHANNEL_READY_TO_DELIVER=n.CHANNEL_NOT_READY_TO_DELIVER=n.CANCEL_TRANSACTION_CHANNEL=n.CANCEL_TRANSACTION_ACTION=void 0;n.MSG_NUM="msg_num";n.MSG_SHARD="msg_shard";n.MESSAGE_REDELIVERY_OPTIONS="msg_redelivery_options";n.CHANNEL_READY_TO_DELIVER="Channel set to deliver messages now: ";n.CHANNEL_NOT_READY_TO_DELIVER="Channel set to not deliver messages until re-subscription & re-delivery of missed messages is over: ";n.META_HANDSHAKE="/meta/handshake";n.WS_CONNECTION_NODE_ID="glide.amb.wsConnectionNodeId";n.NODEID_COOKIE_KEY="glide_node_id_for_js";n.GLIDE_REMEMBER_ME="glide.remember.me";n.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC="glide.amb.hup.signal.reconnect.in.sec";n.CANCEL_TRANSACTION_CHANNEL="/service/transaction/cancel";n.CANCEL_TRANSACTION_ACTION="cancelTransaction";n.REQUEST_SUCCESS="200::Success";n.REQUEST_ACCEPTED="202::Request accepted";n.MISSING_REQUEST_DATA="400::Missing request data";n.MISSING_INTERACTION_ID="400::Missing nowUiInteractionId id";n.TRANSACTION_ALREADY_SUBMITTED="409::Transaction with nowUiInteraction has already been submitted for cancel";n.PUBLISH_FAILURE="503::Unable to publish message"},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0));var r=function(e,n,t){var r,o,s=new i.default("amb.ChannelListener"),a=e;return{getCallback:function(){return o},getSubscriptionCallback:function(){return t},getID:function(){return r},setNewChannel:function(e){a.unsubscribe(this),a=e,this.subscribe(o)},subscribe:function(e){return o=e,r=a.subscribe(this),this},resubscribe:function(){return this.subscribe(o)},unsubscribe:function(){return a.unsubscribe(this),s.debug("Unsubscribed from channel: "+a.getName()),this},publish:function(e,n){a.publish(e,n)},getName:function(){return a.getName()}}};n.default=r},function(e,n,t){"use strict";function i(e){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.isUndefined=n.isObject=n.isNull=n.isNil=n.isEmptyObject=void 0;var r=function(e){return void 0===e};n.isUndefined=r;var o=function(e){return null===e};n.isNull=o;n.isNil=function(e){return o(e)||r(e)};var s=function(e){return null!=e&&"object"===i(e)};n.isObject=s;n.isEmptyObject=function(e){return s(e)&&0===Object.keys(e).length}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){var n=[],t=0;return{subscribe:function(e,i){var r=t++;return n.push({event:e,callback:i,id:r}),r},unsubscribe:function(e){for(var t=0;t<n.length;t++)e===n[t].id&&n.splice(t,1)},publish:function(e,n){for(var t=this._getSubscriptions(e),i=0;i<t.length;i++)t[i].callback.apply(null,n)},getEvents:function(){return e},_getSubscriptions:function(e){for(var t=[],i=0;i<n.length;i++)n[i].event===e&&t.push(n[i]);return t}}};n.default=i},function(e,n,t){"use strict";function i(e){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=p(t(5)),o=p(t(0)),s=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=b(n);if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}r.default=e,t&&t.set(e,r);return r}(t(1)),a=p(t(7)),u=p(t(8)),c=p(t(24)),l=t(4),f=p(t(25)),d=p(t(26)),g=p(t(27)),h=t(2);function b(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(b=function(e){return e?t:n})(e)}function p(e){return e&&e.__esModule?e:{default:e}}var v=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c.default,t=!1,i=!1,b=null,p=new r.default({CONNECTION_INITIALIZED:"connection.initialized",CONNECTION_OPENED:"connection.opened",CONNECTION_CLOSED:"connection.closed",CONNECTION_BROKEN:"connection.broken",SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated",SESSION_REESTABLISHED:"session.reestablished"}),v={SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated"},m="closed",_={},y={},T=new o.default("amb.ServerConnection");!function(){e.addListener("/meta/handshake",this,X),e.addListener("/meta/connect",this,ue),e.addListener("/meta/subscribe",this,re),e.addListener("/meta/unsubscribe",this,ee)}();var C=v.SESSION_INVALIDATED,S=null,E="true"===s.default.loginWindow,w=null,I={UNKNOWN_CLIENT:"402::Unknown client",UNKNOWN_SESSION:"402::session_unknown",NODE_MISMATCH:"websocket_http_node_mismatch",RECONNECT_REMEMBER_ME:"reconnect_remember_me_http_activity",HUP_SIGNAL:"reconnect_on_hup_signal"},N=!1,O={},x=!1,k=new a.default(e,O),M=!1,L="glide.amb.session.logout.overlay.style",A="glide.amb.redelivery.disconnect.timeout.in.mins",R="glide.amb.clear_node_affinity_cookie",D="glide.session.status",U="session.touch.http",P="amb.ServerConnection.reestablish.session",B="set.header.request.sent",G="request.reconnection",F=e.getExtension(s.TOKEN_MANAGEMENT_EXTENSION),j=null,q=new g.default(e),H=null,W=!0,z=null,V=null,Q=null,K=null,Y=null;function X(e){ee(e),void 0!==J(e,h.WS_CONNECTION_NODE_ID)&&(b=J(e,h.WS_CONNECTION_NODE_ID),T.debug("Node Id from handshake callback initially set to "+b));var n=J(e,L);n&&(s.default.overlayStyle=n);var t=J(e,A);t&&(s.default.redeliveryDisconnectTimeoutInMins=t),J(e,R)&&(s.default.requestHeaderToClearStickySessionCookie=!0===J(e,R)),C=J(e,D),function(e){if(e.ext){var n=e.ext.subscribeCommandsFlow;if(n){var t=s.default.subscribeCommandsFlow;if(s.default.subscribeCommandsFlow.enable=function(e,n){var t=n;return(0,l.isNil)(e)||(t=!!e),t}(n.enable,t.enable),s.default.subscribeCommandsFlow.enable){s.default.subscribeCommandsFlow.retries=oe(n.retries,t.retries),s.default.subscribeCommandsFlow.maxInflight=oe(n.maxInflight,t.maxInflight),s.default.subscribeCommandsFlow.maxWait=oe(n.maxWait,t.maxWait);var i=n.retryDelay;if(i){var r=s.default.subscribeCommandsFlow.retryDelay;s.default.subscribeCommandsFlow.retryDelay.min=oe(i.min,r.min),s.default.subscribeCommandsFlow.retryDelay.max=oe(i.max,r.max),s.default.subscribeCommandsFlow.retryDelay.increaseFactor=oe(i.increaseFactor,r.increaseFactor)}}!function(){s.default.subscribeCommandsFlow.enable&&(T.addInfoMessage("_initializeSubscriptionCommandSender: SubscriptionCommandSender is enabled"),null!=F&&F.updateTokenCount(s.default.subscribeCommandsFlow.maxInflight),j&&j.stop(),j=new d.default(new f.default(1e4),F))}()}}}(e),setTimeout(function(){e.successful&&ce()},0)}function J(e,n){if((0,l.isObject)(e.ext))return e.ext[n]}function $(n,t){if(n in _)return _[n];var i=new u.default(e,n,M,t);return _[n]=i,i}function Z(e){y[e]=_[e],delete _[e]}function ee(n){if(n.ext){!1===n.ext["glide.amb.active"]&&O.disconnect();var t=J(n,"glide.amb.client.log.level");t&&(s.default.logLevel=t,e.setLogLevel(s.default.logLevel)),s.default.pruneFailedTransports="false"!==J(n,"glide.amb.pruneFailedTransports")}}function ne(){null!==te()&&(clearInterval(V),V=null,z=null,x=!0,w=I.RECONNECT_REMEMBER_ME,O.connect())}function te(){if(void 0!==document.cookie)for(var e=document.cookie.split(";"),n=0;n<e.length;n++){var t=e[n].trim();if(t.startsWith("".concat(h.NODEID_COOKIE_KEY,"=")))return t.substring(h.NODEID_COOKIE_KEY.length+1)}return null}function ie(n){b=null,i=!0,e.disconnect(function(){T.addInfoMessage("Disconnected WS Connection. Connecting back"),w=n,t=!1,ge(),Q=null,x=!0,i=!1,O.connect()})}function re(e){ee(e)}function oe(e,n){var t=Math.floor(parseInt(e));return(isNaN(t)||t<0)&&(t=n),t}function se(){for(var e in T.debug("Resubscribing to all!"),_){var n=_[e];n&&n.resubscribeToCometD()}}function ae(){for(var e in T.debug("Unsubscribing from all!"),_){var n=_[e];n&&n.unsubscribeFromCometD()}}function ue(n){if(ee(n),J(n,h.GLIDE_REMEMBER_ME)&&(z=J(n,h.GLIDE_REMEMBER_ME)),J(n,h.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)&&function(e){Q||(Q=setTimeout(function(){T.addInfoMessage("Reconnecting after "+e+"sec as the server received an HUP signal from load balancer"),ie(I.HUP_SIGNAL)},1e3*e))}(J(n,h.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)),i)setTimeout(function(){t=!1,ge()},0);else{t&&!be(J(n,D))&&function(){if(null!==b){var e=te();null!==e&&b!==e&&setTimeout(function(){null!==(e=te())&&b!==e&&(T.addInfoMessage("WS Connection is with "+b+" whereas httpsession is with "+e+". Disconnecting WS connection"),ie(I.NODE_MISMATCH))},2e4)}}();var r=J(n,U);(function(){return s.WEBSOCKET_TYPE_NAME===e.getTransport().getType()})()&&!0===r&&O._touchHttpSession();var o=n.error;o&&(w=o),function(e){var n=J(e,D);n&&n!==C&&(N=!0===J(e,"glide.amb.login.window.override"),he(n))}(n);var a=t;t=!0===n.successful,!a&&t?le():a&&!t&&function(){T.addErrorMessage("Connection broken"),m="broken",x=!0,me(p.getEvents().CONNECTION_BROKEN),H=Date.now(),function(){j&&(j.stop(),j=null)}()}(),K=new Date}}function ce(){T.debug("Connection initialized"),M=!0,m="initialized",me(p.getEvents().CONNECTION_INITIALIZED)}function le(){T.debug("Connection opened"),q.processConnectionOpened(),x?function(){!function(e){return Object.values(I).includes(e)}(O.getLastError())?T.addWarnMessage("Error connecting to server. Unkown status "+O.getLastError()):(O.setLastError(null),O._sendSessionSetupRequest(function(e){var n=e.status,t=e.response;if(200===n){x=!1;var i=JSON.parse(t)["glide.session.status"];T.debug("/amb_session_setup.do response: "+t),i&&C!==i?(k.initialize(de),he(i)):k.initialize(function(){fe(!1)})}else T.addWarnMessage("/amb_session_setup.do status: "+n)}))}():k.initialize(function(){fe(!0)})}function fe(e){se(),de(),e&&function(){T.debug("Sending signal to reconnect"),n.emit(G,G)}()}function de(){m="opened",me(p.getEvents().CONNECTION_OPENED)}function ge(){T.debug("Connection closed"),m="closed",me(p.getEvents().CONNECTION_CLOSED)}function he(e){T.debug("session.status - "+e),be(e)?function(){T.debug("INVALIDATED event fire!"),ae(),me(p.getEvents().SESSION_INVALIDATED),function(){return s.default.requestHeaderToClearStickySessionCookie}()&&(void 0!==navigator.locks?navigator.locks.request("lock-set_clear_node_affinity_header",ve):(T.debug("navigator.locks.request not supported"),ve())),pe()||O.disconnect(function(){O.loginHide(),t=!1,ge(),i=!1,z&&function(e){return void 0!==document.cookie&&(document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",!0)}(h.NODEID_COOKIE_KEY)&&(V=setInterval(ne,5e3))})}():function(e){return C===v.SESSION_LOGGED_IN&&e===v.SESSION_LOGGED_OUT}(e)?function(){T.debug("LOGGED_OUT event fire!"),ae(),me(p.getEvents().SESSION_LOGGED_OUT),E&&!N&&O.loginShow(),pe()}():function(e){return C===v.SESSION_INVALIDATED&&e===v.SESSION_LOGGED_OUT}(e)?function(){T.debug("REESTABLISHED event fire!"),se(),me(p.getEvents().SESSION_REESTABLISHED)}():function(e){return(C===v.SESSION_INVALIDATED||C===v.SESSION_LOGGED_OUT)&&e===v.SESSION_LOGGED_IN}(e)&&function(){T.debug("LOGGED_IN event fire!"),se(),me(p.getEvents().SESSION_LOGGED_IN),O.loginHide(),W=!0}(),C=e}function be(e){return(C===v.SESSION_LOGGED_IN||C===v.SESSION_LOGGED_OUT)&&e===v.SESSION_INVALIDATED}function pe(){return!!(K&&Y&&Y>K)&&(T.debug("Either the session is logged out/invalidated from a different tab. Calling reestablishSession as lastReconnectionEventTime "+Y+" happened after lastMetaConnectResponseTime "+K),_e(!1),!0)}function ve(){W?(T.debug("Sending set_clear_node_affinity_header"),function(){n.emit(B,B)}(),O._sendSetHeaderToClearNodeAffinityCookie(function(e){var n=e.status;200!==n?T.addErrorMessage("Error sending set_clear_node_affinity_header: "+n):W=!1})):T.debug("set_clear_node_affinity_header not sent")}function me(e){try{p.publish(e)}catch(n){T.addErrorMessage("error publishing '"+e+"' - "+n)}}function _e(e){O._sendSessionSetupRequest(function(e){var n=e.response;n&&he(JSON.parse(n)["glide.session.status"])}),e&&function(){n.emit(P,P)}()}return O.connect=function(){t?T.debug(">>> connection exists, request satisfied"):(T.debug("Connecting to glide amb server -> "+s.default.servletURI),e.configure({url:O.getURL(s.default.servletPath),logLevel:s.default.logLevel,connectTimeout:s.default.wsConnectTimeout}),e.handshake(),n.on(P,function(){O._reestablishSession(!1)}),n.on(B,function(){W=!1}),n.on(G,function(){T.debug("Received signal to reconnect"),function(){t?C===v.SESSION_LOGGED_OUT?_e(!1):C===v.SESSION_LOGGED_IN&&(Y=new Date):O.connect()}()}))},O.reload=function(){e.reload()},O.abort=function(){e.getTransport().abort()},O.disconnect=function(n){T.debug("Disconnecting from glide amb server.."),i=!0,e.disconnect(n)},O.getURL=function(e){return window.location.protocol+"//"+window.location.host+"/"+e},O.getConnectionBrokenTS=function(){return H},O.unsubscribeAll=function(){ae()},O.resubscribeAll=function(){se()},O.removeChannel=function(e){Z(e)},O.getEvents=function(){return p.getEvents()},O.getConnectionState=function(){return m},O.getLastError=function(){return w},O.setLastError=function(e){w=e},O.getErrorMessages=function(){return I},O.isLoggedIn=function(){return C===v.SESSION_LOGGED_IN},O.isSessionActive=function(){return C!==v.SESSION_INVALIDATED},O.getChannelRedirect=function(){return k},O.getChannel=function(e,n){return $(e,n)},O.getChannels=function(){return _},O.getRemovedChannels=function(){return y},O.getState=function(){return m},O.getLoginWindowOverlayStyle=function(){return s.default.overlayStyle},O.loginShow=function(){T.debug("Show login window");var e='<iframe src="/amb_login.do" style="border: 0" height="400px" width="405px"></iframe>',n='<div id="amb_disconnect_modal" tabindex="-1" aria-hidden="true" class="modal" role="dialog" style="'.concat(s.default.overlayStyle,'">\n\t\t\t\t<div class="modal-dialog small-modal" style="width:450px">\n\t\t\t\t   <div class="modal-content">\n\t\t\t\t\t  <header class="modal-header">\n\t\t\t\t\t\t <h4 id="small_modal1_title" class="modal-title">Login</h4>\n\t\t\t\t\t  </header>\n\t\t\t\t\t  <div class="modal-body">\n\t\t\t\t\t  </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t</div>');try{if(window.NOW&&!0===window.NOW.amb_themed_login){var t=new GlideModal("amb_login_router");t.renderWithContent&&(t.template=n),t.render(),S=t}else{var i=new GlideModal("amb_disconnect_modal");i.renderWithContent?(i.template=n,i.renderWithContent(e)):(i.setBody(e),i.render()),S=i}}catch(e){T.debug(e)}},O.loginHide=function(){S&&(S.destroy(),S=null)},O.loginComplete=function(){O.reestablishSession()},O.reestablishSession=function(){O._reestablishSession(!0)},O.subscribeToEvent=function(e,n){return p.getEvents().CONNECTION_OPENED===e&&t&&n(),p.subscribe(e,n)},O.unsubscribeFromEvent=function(e){p.unsubscribe(e)},O.isLoginWindowEnabled=function(){return E},O.setLoginWindowEnabled=function(e){E=e},O.isLoginWindowOverride=function(){return N},O.getSubscriptionCommandSender=function(){return j},O._metaConnect=ue,O._metaHandshake=X,O._metaSubscribe=re,O._sendSessionSetupRequest=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=function(){T.debug("sending /amb_session_setup.do!");var n=new XMLHttpRequest;return n.open("POST","/amb_session_setup.do",!0),n.setRequestHeader("Content-type","application/json;charset=UTF-8"),n.setRequestHeader("X-UserToken",window.g_ck),n.setRequestHeader("X-CometD-SessionID",e.getClientId()),n}();t.onload=function(){return n(t)},t.send()},O._onChannelRedirectSubscriptionComplete=fe,O._getChannel=$,O._removeChannel=Z,O._connectionInitialized=ce,O._connectionOpened=le,O._reestablishSession=_e,O._touchHttpSession=function(){var e=new XMLHttpRequest;e.open("POST","/amb",!0),e.setRequestHeader("Content-type","application/json"),e.send()},O._sendSetHeaderToClearNodeAffinityCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=function(){var e=new XMLHttpRequest;return e.open("POST","/set_clear_node_affinity_header",!0),e}();n.onload=function(){return e(n)},n.send()},O};n.default=v},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(0)),r=o(t(3));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e,n){var t,o=e,s=new i.default("amb.ChannelRedirect");function a(e){s.debug("_onAdvice:"+e.data.clientId);var t=n.getChannels(),i=null!=t?t[e.data.fromChannel]:null;if(!i){var r=n.getRemovedChannels();i=null!=r?r[e.data.fromChannel]:null}var o=n.getChannel(e.data.toChannel);i&&o?(function(e,n){for(var t=e.getChannelListeners(),i=0;i<t.length;i++)t[i].setNewChannel(n)}(i,o),s.debug("published channel switch event, fromChannel:"+i.getName()+", toChannel:"+o.getName())):s.debug("Could not redirect from "+e.data.fromChannel+" to "+e.data.toChannel)}return{initialize:function(e){var i="/sn/meta/channel_redirect/"+o.getClientId(),u=n.getChannel(i);t&&u===t?t.subscribeToCometD():(t&&n.removeChannel(t.getName()),t=u,new r.default(t,n,e).subscribe(a)),s.debug("ChannelRedirect initialized: "+i)},_onAdvice:a}};n.default=s},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=c(t(0)),r=t(4),o=c(t(9)),s=c(t(23)),a=c(t(1)),u=t(2);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e,n,t){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return{}},l=null,f=null,d=[],g=[],h=new i.default("amb.Channel"),b=0,p=t,v=-1,m=null,_=!0,y=new s.default;function T(){return(0,o.default)().getServerConnection().getSubscriptionCommandSender()}return{subscribe:function(e){if(e.getCallback()){for(var t=0;t<d.length;t++)if(d[t]===e)return h.debug("Channel listener already in the list"),e.getID();d.push(e);var i=e.getSubscriptionCallback();if(i&&(f?i(f):g.push(i)),!l&&p)try{this.subscribeToCometD()}catch(e){return void h.addErrorMessage(e)}return++b}h.addErrorMessage("Cannot subscribe to channel: "+n+", callback not provided")},resubscribe:function(){l=null;for(var e=0;e<d.length;e++)d[e].resubscribe()},_handleResponse:function(e){_?this.processMessageCallback(e):this.processReSubscriptionMessages(e)},processReSubscriptionMessages:function(e){var t=this;y.shouldDeliver(e)?(h.debug(u.CHANNEL_READY_TO_DELIVER+n),_=!0,this.processMessageCallback(e)):y.shouldDeliverPendingMessages()&&y.getAllPendingMessages().forEach(function(e){return t.processMessageCallback(e)})},processMessageCallback:function(e){for(var n=0;n<d.length;n++)d[n].getCallback()(e);y.containsMetaInfo(e)&&(v=e.ext[u.MSG_NUM],m=e.ext[u.MSG_SHARD])},unsubscribe:function(t){if(t){for(var i=0;i<d.length;i++)if(d[i].getID()===t.getID()){d.splice(i,1);break}d.length<1&&l&&!function(){var n=e.getStatus();return"disconnecting"===n||"disconnected"===n}()&&this.unsubscribeFromCometD()}else h.addErrorMessage("Cannot unsubscribe from channel: "+n+", listener argument does not exist")},publish:function(t,i){e.publish(n,t,i)},subscribeToCometD:function(){h.debug("subscribeToCometD channelName : "+n+", subscription : "+l),T()?T().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},_subscribeToCometD:function(t){h.debug("_subscribeToCometD channelName : "+n);var i=this._populateSubscriptionOptions();if((0,r.isNil)(i)||(0,r.isEmptyObject)(i))l=e.subscribe(n,this._handleResponse.bind(this),t);else{var o={subscribeOptions:i};l=e.subscribe(n,this._handleResponse.bind(this),o,t)}h.debug("Successfully subscribed to channel: "+n+", subscribeOptions: "+JSON.stringify(i))},_populateSubscriptionOptions:function(){var e=c(),t=Date.now()-this.fetchDisconnectionTS();return this._shouldRedeliveryBeRequested(t)&&((0,r.isNil)(e)&&(e={}),e[u.MESSAGE_REDELIVERY_OPTIONS]={},e[u.MESSAGE_REDELIVERY_OPTIONS].last_msg_num=v,e[u.MESSAGE_REDELIVERY_OPTIONS].last_msg_shard=m,e[u.MESSAGE_REDELIVERY_OPTIONS].request_duration=t,h.debug(u.CHANNEL_NOT_READY_TO_DELIVER+n),_=!1,y.resetState()),e},_shouldRedeliveryBeRequested:function(e){return e<=6e4*a.default.redeliveryDisconnectTimeoutInMins&&-1!=v&&!(0,r.isNil)(m)},subscriptionCallback:function(e){h.debug("Cometd subscription callback completed for channel: "+n),h.debug("Listener callback queue size: "+g.length),f=e,g.map(function(e){e(f)}),g=[]},unsubscribeFromCometD:function(){h.debug("unsubscribeFromCometD  from : "+n+", subscription : "+l),null!==l&&(T()?T().unsubscribeToChannel(this):this._unsubscribeFromCometD())},_unsubscribeFromCometD:function(){h.debug("_unsubscribeFromCometD  from : "+n+", subscription : "+l),null!==l&&(e.unsubscribe(l),l=null,f=null,h.debug("Successfully unsubscribed from channel: "+n))},resubscribeToCometD:function(){h.debug("Resubscribe to "+n),T()?T().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},getSubscribeOptionsCallback:function(){return c},getName:function(){return n},getChannelListeners:function(){return d},getLastMessageShard:function(){return m},getLastMessageNumber:function(){return v},fetchDisconnectionTS:function(){var e=(0,o.default)().getServerConnection().getConnectionBrokenTS();return h.debug("Client Disconnect Time in ms:"+e),e||0},getRedeliveryManager:function(){return y},isReadyToDeliver:function(){return _},getListenerCallbackQueue:function(){return g},setSubscriptionCallbackResponse:function(e){f=e}}};n.default=l},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t(10)),r=s(t(19)),o=s(t(22));function s(e){return e&&e.__esModule?e:{default:e}}function a(e){return e.MSInputMethodContext&&e.document.documentMode}function u(e,n){if(void 0!==e.getClientWindow&&e.getClientWindow()===n)return e;var t=function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}({},e);return t.getChannel=function(t,i,r){return e.getChannel(t,i,r||n)},t.getRecordWatcherChannel=function(t,i,r,o,s){return e.getRecordWatcherChannel(t,i,r,o,s||n)},t.subscribeToEvent=function(t,i,r){return e.subscribeToEvent(t,i,r||n)},t.unsubscribeFromEvent=function(t,i){return e.unsubscribeFromEvent(t,i||n)},t.getClientWindow=function(){return n},t}var c=function(){var e=function(e){try{if(!a(e))for(;e!==e.parent&&!e.g_ambClient;)e=e.parent;if(e.g_ambClient)return e.g_ambClient}catch(e){console.log("AMB getClient() tried to access parent from an iFrame. Caught error: "+e)}return null}(window);e||function(e){var n=window.self;n.g_ambClient=e,n.addEventListener("unload",function(){n.g_ambClient.disconnect()});var t=!(!n.NOW||!n.NOW.hasOwnProperty("deferAmbConnection"))&&n.NOW.deferAmbConnection,i=n.NOW&&n.NOW.hasOwnProperty("deferredAmbConnectionTimeout")&&function(e){return function(e){return parseInt(e,10)===e}(e)&&e>0}(n.NOW.deferredAmbConnectionTimeout)?n.NOW.deferredAmbConnectionTimeout:1e4;if(t)n.setTimeout(s,i);else{var r=n.document?n.document.readyState:null;"complete"===r?s():n.addEventListener("load",s),n.setTimeout(s,1e4)}var o=!1;function s(){o||(o=!0,n.g_ambClient.connect())}}(e=u(function(e){return function(){var n=new i.default,t=function(){var e=[];function n(e,n,i){if(e&&i){var r=t(e);if(r)for(var o=r.subscriptions,s=o.length-1;s>=0;s--)o[s].id===n&&o[s].callback===i&&o.splice(s,1)}}function t(n){for(var t=0,i=e.length;t<i;t++)if(e[t].window===n)return e[t];return null}function i(n){var t={window:n,onUnload:function(){t.unloading=!0;for(var n,i=t.subscriptions;n=i.pop();)n.unsubscribe();!function(n){for(var t=0,i=e.length;t<i;t++)if(e[t].window===n.window){e.splice(t,1);break}n.subscriptions=[],n.window.removeEventListener("unload",n.onUnload),n.onUnload=null,n.window=null}(t)},unloading:!1,subscriptions:[]};return n.addEventListener("unload",t.onUnload),e.push(t),t}return{add:function(e,r,o,s){if(e&&o&&s){n(e,r,o);var a=t(e);a||(a=i(e)),a.unloading||a.subscriptions.push({id:r,callback:o,unsubscribe:s})}},remove:n}}(),s=n.getServerConnection();return e&&s.setLoginWindowEnabled(!1),{getServerConnection:function(){return s},connect:function(){n.connect()},abort:function(){n.abort()},disconnect:function(){n.disconnect()},getConnectionState:function(){return n.getConnectionState()},getState:function(){return n.getConnectionState()},cancelTransaction:function(e){n.cancelTransaction(e)},getClientId:function(){return n.getClientId()},getChannel:function(e,i,r){var o=n.getChannel(e,i),a=o.subscribe,u=o.unsubscribe;return r=r||window,o.subscribe=function(e){return t.add(r,o,e,function(){o.unsubscribe(e)}),a.call(o,e),o},o.unsubscribe=function(i){t.remove(r,o,i);var a=u.call(o,i);return 0===s.getChannel(e).getChannelListeners().length&&n.removeChannel(e),a},o},getChannel0:function(e,t){return n.getChannel(e,t)},getRecordWatcherChannel:function(e,n,t,i,s){var a=r.default.stringify(o.default.parse(n)).replace(/=/g,"-");return t=t||"default",this.getChannel("/rw/"+t+"/"+e+"/"+a,i,s)},registerExtension:function(e,t){n.registerExtension(e,t)},unregisterExtension:function(e){n.unregisterExtension(e)},batch:function(e){n.batch(e)},subscribeToEvent:function(e,i,r){r=r||window;var o=n.subscribeToEvent(e,i);return t.add(r,o,!0,function(){n.unsubscribeFromEvent(o)}),o},unsubscribeFromEvent:function(e,i){i=i||window,t.remove(i,e,!0),n.unsubscribeFromEvent(e)},isLoggedIn:function(){return n.isLoggedIn()},getConnectionEvents:function(){return n.getConnectionEvents()},getEvents:function(){return n.getConnectionEvents()},reestablishSession:function(){n.reestablishSession()},loginComplete:function(){n.loginComplete()},getChannels:function(){return n.getChannels()},extendSession:function(){return n.extendSession()},getTokenManagementExtension:function(){return n.getTokenManagementExtension()}}}()}(a(window)&&null!==window.frameElement),window));return u(e,window)};n.default=c},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=d(t(14)),r=d(t(6)),o=d(t(0)),s=d(t(3)),a=d(t(15)),u=t(1),c=d(t(16)),l=d(t(17)),f=d(t(18));function d(e){return e&&e.__esModule?e:{default:e}}var g=function(){var e=new i.default.CometD;e.registerTransport(u.WEBSOCKET_TYPE_NAME,new i.default.WebSocketTransport,0),e.registerTransport("long-polling",new i.default.LongPollingTransport,1),e.unregisterTransport("callback-polling");var n=new a.default;e.registerExtension("graphQLSubscription",n);var t=new c.default;e.registerExtension("sessionExtension",t);var d=new l.default;e.registerExtension(u.TOKEN_MANAGEMENT_EXTENSION,d);var g=new r.default(e),h=new o.default("amb.MessageClient"),b=new f.default,p=!1;return{getServerConnection:function(){return g},isLoggedIn:function(){return g.isLoggedIn()},loginComplete:function(){g.loginComplete()},reestablishSession:function(){g.reestablishSession()},connect:function(){p?h.addInfoMessage(">>> connection exists, request satisfied"):(p=!0,g.connect())},reload:function(){p=!1,g.reload()},abort:function(){p=!1,g.abort()},disconnect:function(){p=!1,g.disconnect()},isConnected:function(){return p},getConnectionEvents:function(){return g.getEvents()},subscribeToEvent:function(e,n){return g.subscribeToEvent(e,n)},unsubscribeFromEvent:function(e){g.unsubscribeFromEvent(e)},getConnectionState:function(){return g.getConnectionState()},getClientId:function(){return e.getClientId()},getChannel:function(e,t){var i=t||{},r=i.subscriptionCallback,o=i.serializedGraphQLSubscription,a=i.subscribeOptionsCallback,u=g.getChannel(e,a);return n.isGraphQLChannel(e)&&(o?n.addGraphQLChannel(e,o):h.addErrorMessage("Serialized subscription not present for GraphQL channel "+e)),new s.default(u,g,r)},removeChannel:function(e){g.removeChannel(e),n.isGraphQLChannel(e)&&n.removeGraphQLChannel(e)},getChannels:function(){return g.getChannels()},cancelTransaction:function(e){b.cancelTransaction(e,this)},extendSession:function(){t.extendSession()},getTokenManagementExtension:function(){return d},registerExtension:function(n,t){e.registerExtension(n,t)},unregisterExtension:function(n){e.unregisterExtension(n)},batch:function(n){e.batch(n)}}};n.default=g},function(e,n,t){(function(i){!function(t,i){e.exports=n=i()}(0,function(){var e=e||function(e,n){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==i&&i.crypto&&(r=i.crypto),!r)try{r=t(21)}catch(e){}var o=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(n){var t;return e.prototype=n,t=new e,e.prototype=null,t}}(),a={},u=a.lib={},c=u.Base=function(){return{extend:function(e){var n=s(this);return e&&n.mixIn(e),n.hasOwnProperty("init")&&this.init!==n.init||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=u.WordArray=c.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=void 0!=n?n:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=t[o>>>2]>>>24-o%4*8&255;n[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<r;a+=4)n[i+a>>>2]=t[a>>>2];return this.sigBytes+=r,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-t%4*8,n.length=e.ceil(t/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var n=[],t=0;t<e;t+=4)n.push(o());return new l.init(n,e)}}),f=a.enc={},d=f.Hex={stringify:function(e){for(var n=e.words,t=e.sigBytes,i=[],r=0;r<t;r++){var o=n[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new l.init(t,n/2)}},g=f.Latin1={stringify:function(e){for(var n=e.words,t=e.sigBytes,i=[],r=0;r<t;r++){var o=n[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new l.init(t,n)}},h=f.Utf8={stringify:function(e){try{return decodeURIComponent(escape(g.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return g.parse(unescape(encodeURIComponent(e)))}},b=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t,i=this._data,r=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),u=(a=n?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,c=e.min(4*u,o);if(u){for(var f=0;f<u;f+=s)this._doProcessBlock(r,f);t=r.splice(0,u),i.sigBytes-=c}return new l.init(t,c)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(u.Hasher=b.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new p.HMAC.init(e,t).finalize(n)}}}),a.algo={});return a}(Math);return e})}).call(n,t(20))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(13));window.__TECTONIC__amb_client_js=i.default,window.amb=i.default;n.default=i.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=d(t(1)),r=d(t(0)),o=d(t(5)),s=d(t(6)),a=d(t(7)),u=d(t(3)),c=d(t(8)),l=d(t(10)),f=d(t(9));function d(e){return e&&e.__esModule?e:{default:e}}var g={properties:i.default,Logger:r.default,EventManager:o.default,ServerConnection:s.default,ChannelRedirect:a.default,ChannelListener:u.default,Channel:c.default,MessageClient:l.default,getClient:f.default};n.default=g},function(e,n,t){!function(n,t){e.exports=t()}(0,function(){var e={isString:function(e){return void 0!==e&&null!==e&&("string"==typeof e||e instanceof String)},isArray:function(e){return void 0!==e&&null!==e&&e instanceof Array},inArray:function(e,n){for(var t=0;t<n.length;++t)if(e===n[t])return t;return-1}},n=function(){var n,t,i;this.registered=function(e,i){n=e,t=i},this.unregistered=function(){n=null,t=null},this._notifyTransportTimeout=function(e){var n=t._getTransportListeners("timeout");if(n)for(var i=0;i<n.length;++i){var r=n[i];try{var o=r.call(this,e);if("number"==typeof o&&o>0)return o}catch(e){this._info("Exception during execution of transport listener",r,e)}}return 0},this._debug=function(){t._debug.apply(t,arguments)},this._info=function(){t._info.apply(t,arguments)},this._mixin=function(){return t._mixin.apply(t,arguments)},this.getConfiguration=function(){return t.getConfiguration()},this.getAdvice=function(){return t.getAdvice()},this.setTimeout=function(e,n){return t.setTimeout(e,n)},this.clearTimeout=function(e){t.clearTimeout(e)},this.convertToJSON=function(e){for(var n=this.getConfiguration().maxSendBayeuxMessageSize,t="[",i=0;i<e.length;++i){i>0&&(t+=",");var r=e[i],o=JSON.stringify(r);if(o.length>n)throw"maxSendBayeuxMessageSize "+n+" exceeded";t+=o}return t+="]"},this.convertToMessages=function(n){if(e.isString(n))try{return JSON.parse(n)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+n+'"'),e}if(e.isArray(n))return n;if(void 0===n||null===n)return[];if(n instanceof Object)return[n];throw"Conversion Error "+n+", typeof "+typeof n},this.accept=function(e,n,t){throw"Abstract"},this.getType=function(){return n},this.getURL=function(){return i},this.setURL=function(e){i=e},this.send=function(e,n){throw"Abstract"},this.reset=function(e){this._debug("Transport",n,"reset",e?"initial":"retry")},this.abort=function(){this._debug("Transport",n,"aborted")},this.toString=function(){return this.getType()}};n.derive=function(e){function n(){}return n.prototype=e,new n};var t=function(){var t=new n,i=n.derive(t),r=0,o=null,s=[],a=[];function u(e,n){if(this.transportSend(e,n)&&(n.expired=!1,!e.sync)){var t=this.getConfiguration().maxNetworkDelay;!0===n.metaConnect&&(t+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"started waiting for message replies of request",n.id,":",t,"ms");var i=this;n.timeout=this.setTimeout(function(){(function e(n,t,i){var r=this._notifyTransportTimeout(n.messages);if(r>0){this._debug("Transport",this.getType(),"extended waiting for message replies of request",t.id,":",r,"ms");var o=this;t.timeout=this.setTimeout(function(){e.call(o,n,t,i+r)},r)}else{t.expired=!0;var s="Transport "+this.getType()+" expired waiting for message replies of request "+t.id+": "+i+" ms",a={reason:s},u=t.xhr;a.httpCode=this.xhrStatus(u),this.abortXHR(u),this._debug(s),this.complete(t,!1,t.metaConnect),n.onFailure(u,n.messages,a)}}).call(i,e,n,t)},t)}}function c(e){var n=++r,t={id:n,metaConnect:!1,envelope:e};s.length<this.getConfiguration().maxConnections-1?(s.push(t),u.call(this,e,t)):(this._debug("Transport",this.getType(),"queueing request",n,"envelope",e),a.push([e,t]))}function l(n,t){var i=e.inArray(n,s);if(i>=0&&s.splice(i,1),a.length>0){var r=a.shift(),o=r[0],u=r[1];if(this._debug("Transport dequeued request",u.id),t)this.getConfiguration().autoBatch&&function(e){for(;a.length>0;){var n=a[0],t=n[0],i=n[1];if(t.url!==e.url||t.sync!==e.sync)break;a.shift(),e.messages=e.messages.concat(t.messages),this._debug("Coalesced",t.messages.length,"messages from request",i.id)}}.call(this,o),c.call(this,o),this._debug("Transport completed request",n.id,o);else{var l=this;this.setTimeout(function(){l.complete(u,!1,u.metaConnect);var e={reason:"Previous request failed"},n=u.xhr;e.httpCode=l.xhrStatus(n),o.onFailure(n,o.messages,e)},0)}}}return i.complete=function(e,n,t){t?function(e){var n=e.id;if(this._debug("Transport",this.getType(),"/meta/connect complete, request",n),null!==o&&o.id!==n)throw"/meta/connect request mismatch, completing request "+n;o=null}.call(this,e):l.call(this,e,n)},i.transportSend=function(e,n){throw"Abstract"},i.transportSuccess=function(e,n,t){n.expired||(this.clearTimeout(n.timeout),this._debug("Transport",this.getType(),"cancelled waiting for message replies"),this.complete(n,!0,n.metaConnect),t&&t.length>0?e.onSuccess(t):e.onFailure(n.xhr,e.messages,{httpCode:204}))},i.transportFailure=function(e,n,t){n.expired||(this.clearTimeout(n.timeout),this._debug("Transport",this.getType(),"cancelled waiting for failed message replies"),this.complete(n,!1,n.metaConnect),e.onFailure(n.xhr,e.messages,t))},i.send=function(e,n){n?function(e){if(null!==o)throw"Concurrent /meta/connect requests not allowed, request id="+o.id+" not yet completed";var n=++r;this._debug("Transport",this.getType(),"/meta/connect send, request",n,"envelope",e);var t={id:n,metaConnect:!0,envelope:e};u.call(this,e,t),o=t}.call(this,e):c.call(this,e)},i.abort=function(){t.abort();for(var e=0;e<s.length;++e){var n=s[e];n&&(this._debug("Aborting request",n),this.abortXHR(n.xhr)||this.transportFailure(n.envelope,n,{reason:"abort"}))}var i=o;i&&(this._debug("Aborting /meta/connect request",i),this.abortXHR(i.xhr)||this.transportFailure(i.envelope,i,{reason:"abort"})),this.reset(!0)},i.reset=function(e){t.reset(e),o=null,s=[],a=[]},i.abortXHR=function(e){if(e)try{var n=e.readyState;return e.abort(),n!==window.XMLHttpRequest.UNSENT}catch(e){this._debug(e)}return!1},i.xhrStatus=function(e){if(e)try{return e.status}catch(e){this._debug(e)}return-1},i},i=function(){var e=new t,i=n.derive(e),r=!0;return i.accept=function(e,n,t){return r||!n},i.newXMLHttpRequest=function(){return new window.XMLHttpRequest},i.xhrSend=function(e){var n=i.newXMLHttpRequest();!function(e){try{e.context=i.context}catch(e){i._debug("Could not copy transport context into XHR",e)}}(n),n.withCredentials=!0,n.open("POST",e.url,!0!==e.sync);var t=e.headers;if(t)for(var r in t)t.hasOwnProperty(r)&&n.setRequestHeader(r,t[r]);return n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){200===n.status?e.onSuccess(n.responseText):e.onError(n.statusText)},n.onabort=n.onerror=function(){e.onError(n.statusText)},n.send(e.body),n},i.transportSend=function(e,n){this._debug("Transport",this.getType(),"sending request",n.id,"envelope",e);var t=this;try{var i=!0;return n.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:this.convertToJSON(e.messages),onSuccess:function(i){t._debug("Transport",t.getType(),"received response",i);var o=!1;try{var s=t.convertToMessages(i);0===s.length?(r=!1,t.transportFailure(e,n,{httpCode:204})):(o=!0,t.transportSuccess(e,n,s))}catch(i){if(t._debug(i),!o){r=!1;var a={exception:i};a.httpCode=t.xhrStatus(n.xhr),t.transportFailure(e,n,a)}}},onError:function(o,s){t._debug("Transport",t.getType(),"received error",o,s),r=!1;var a={reason:o,exception:s};a.httpCode=t.xhrStatus(n.xhr),i?t.setTimeout(function(){t.transportFailure(e,n,a)},0):t.transportFailure(e,n,a)}}),i=!1,!0}catch(i){return this._debug("Transport",this.getType(),"exception:",i),r=!1,this.setTimeout(function(){t.transportFailure(e,n,{exception:i})},0),!1}},i.reset=function(n){e.reset(n),r=!0},i},r=function(){var e=new t,i=n.derive(e),r=0;function o(e,n,t){var i=this;return function(){i.transportFailure(e,n,"error",t)}}return i.accept=function(e,n,t){return!0},i.jsonpSend=function(e){var n=document.getElementsByTagName("head")[0],t=document.createElement("script"),i="_cometd_jsonp_"+r++;window[i]=function(r){n.removeChild(t),delete window[i],e.onSuccess(r)};var o=e.url;o+=o.indexOf("?")<0?"?":"&",o+="jsonp="+i,o+="&message="+encodeURIComponent(e.body),t.src=o,t.async=!0!==e.sync,t.type="application/javascript",t.onerror=function(n){e.onError("jsonp "+n.type)},n.appendChild(t)},i.transportSend=function(e,n){for(var t=this,i=0,r=e.messages.length,s=[];r>0;){var a=JSON.stringify(e.messages.slice(i,i+r)),u=e.url.length+encodeURI(a).length,c=this.getConfiguration().maxURILength;if(u>c){if(1===r){var l="Bayeux message too big ("+u+" bytes, max is "+c+") for transport "+this.getType();return void this.setTimeout(o.call(this,e,n,l),0)}--r}else s.push(r),i+=r,r=e.messages.length-i}var f=e;if(s.length>1){var d=0,g=s[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",s.join(" + ")),(f=this._mixin(!1,{},e)).messages=e.messages.slice(d,g),f.onSuccess=e.onSuccess,f.onFailure=e.onFailure;for(var h=1;h<s.length;++h){var b=this._mixin(!1,{},e);d=g,g+=s[h],b.messages=e.messages.slice(d,g),b.onSuccess=e.onSuccess,b.onFailure=e.onFailure,this.send(b,n.metaConnect)}}this._debug("Transport",this.getType(),"sending request",n.id,"envelope",f);try{var p=!0;return this.jsonpSend({transport:this,url:f.url,sync:f.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(f.messages),onSuccess:function(e){var i=!1;try{var r=t.convertToMessages(e);0===r.length?t.transportFailure(f,n,{httpCode:204}):(i=!0,t.transportSuccess(f,n,r))}catch(e){t._debug(e),i||t.transportFailure(f,n,{exception:e})}},onError:function(e,i){var r={reason:e,exception:i};p?t.setTimeout(function(){t.transportFailure(f,n,r)},0):t.transportFailure(f,n,r)}}),p=!1,!0}catch(e){return this.setTimeout(function(){t.transportFailure(f,n,{exception:e})},0),!1}},i},o=function(){var t,i=new n,r=n.derive(i),o=!0,s=!1,a=!0,u=null,c=null,l=!1,f=null;function d(e,n){e&&(this.webSocketClose(e,n.code,n.reason),this.onClose(e,n))}function g(e){return e===c||e===u}function h(e,n,t){for(var i=[],r=0;r<n.messages.length;++r){var o=n.messages[r];o.id&&i.push(o.id)}e.envelopes[i.join(",")]=[n,t],this._debug("Transport",this.getType(),"stored envelope, envelopes",e.envelopes)}function b(n,t){for(var i=!1,r=n.envelopes,o=0;o<t.length;++o){var s=t[o];for(var a in r)if(r.hasOwnProperty(a)){var u=a.split(","),c=e.inArray(s,u);if(c>=0){i=!0,u.splice(c,1);var l=r[a][0],f=r[a][1];delete r[a],u.length>0&&(r[u.join(",")]=[l,f]);break}}}i&&this._debug("Transport",this.getType(),"removed envelope, envelopes",r)}function p(e,n,t){var i=this._notifyTransportTimeout([n]);if(i>0){this._debug("Transport",this.getType(),"extended waiting for message replies:",i,"ms");var r=this;e.timeouts[n.id]=this.setTimeout(function(){p.call(r,e,n,t+i)},i)}else this._debug("Transport",this.getType(),"expired waiting for message reply",n.id,":",t,"ms"),d.call(this,e,{code:1e3,reason:"Message Timeout"})}function v(e,n,t){var i=this;try{var r=this.convertToJSON(n.messages)}catch(t){this._debug("Transport",this.getType(),"exception:",t);for(var o=[],s=0;s<n.messages.length;++s){var a=n.messages[s];o.push(a.id)}return b.call(this,e,o),void this.setTimeout(function(){i._notifyFailure(n.onFailure,e,n.messages,{exception:t})},0)}e.webSocket.send(r),this._debug("Transport",this.getType(),"sent",n,"/meta/connect =",t);var u=this.getConfiguration().maxNetworkDelay;t&&(u+=this.getAdvice().timeout,l=!0);for(var c=[],f=0;f<n.messages.length;++f)!function(){var t=n.messages[f];t.id&&(c.push(t.id),e.timeouts[t.id]=i.setTimeout(function(){p.call(i,e,t,u)},u))}();this._debug("Transport",this.getType(),"started waiting for message replies",u,"ms, messageIds:",c,", timeouts:",e.timeouts)}function m(e,n,i){try{null===e?(e=c||{envelopes:{},timeouts:{}},h.call(this,e,n,i),function(e){if(!c){var n=t.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",n);try{var i=t.getConfiguration().protocol;e.webSocket=i?new window.WebSocket(n,i):new window.WebSocket(n),c=e}catch(e){throw o=!1,this._debug("Exception while creating WebSocket object",e),e}a=!1!==t.getConfiguration().stickyReconnect;var r=this,l=t.getConfiguration().connectTimeout;l>0&&(e.connectTimer=this.setTimeout(function(){t._debug("Transport",r.getType(),"timed out while connecting to URL",n,":",l,"ms"),d.call(r,e,{code:1e3,reason:"Connect Timeout"})},l));var f=function(n){n=n||{code:1e3},t._debug("WebSocket onclose",e,n,"connecting",c,"current",u),e.connectTimer&&r.clearTimeout(e.connectTimer),r.onClose(e,n)};e.webSocket.onopen=function(){t._debug("WebSocket onopen",e),e.connectTimer&&r.clearTimeout(e.connectTimer),g(e)?(c=null,u=e,s=!0,r.onOpen(e)):(t._warn("Closing extra WebSocket connection",this,"active connection",u),d.call(r,e,{code:1e3,reason:"Extra Connection"}))},e.webSocket.onclose=f,e.webSocket.onerror=function(){f({code:1e3,reason:"Error"})},e.webSocket.onmessage=function(n){t._debug("WebSocket onmessage",n,e),r.onMessage(e,n)},this._debug("Transport",this.getType(),"configured callbacks on",e)}}.call(this,e)):(h.call(this,e,n,i),v.call(this,e,n,i))}catch(n){var r=this;this.setTimeout(function(){d.call(r,e,{code:1e3,reason:"Exception",exception:n})},0)}}return r.reset=function(e){i.reset(e),o=!0,e&&(s=!1),a=!0,e&&(u=null),c=null,l=!1},r._notifySuccess=function(e,n){e.call(this,n)},r._notifyFailure=function(e,n,t,i){e.call(this,n,t,i)},r.onOpen=function(e){var n=e.envelopes;for(var t in this._debug("Transport",this.getType(),"opened",e,"pending messages",n),n)if(n.hasOwnProperty(t)){var i=n[t],r=i[0],o=i[1];f=r.onSuccess,v.call(this,e,r,o)}},r.onMessage=function(e,n){this._debug("Transport",this.getType(),"received websocket message",n,e);for(var t=!1,i=this.convertToMessages(n.data),r=[],o=0;o<i.length;++o){var s=i[o];if((/^\/meta\//.test(s.channel)||void 0===s.data)&&s.id){r.push(s.id);var a=e.timeouts[s.id];a&&(this.clearTimeout(a),delete e.timeouts[s.id],this._debug("Transport",this.getType(),"removed timeout for message",s.id,", timeouts",e.timeouts))}"/meta/connect"===s.channel&&(l=!1),"/meta/disconnect"!==s.channel||l||(t=!0)}b.call(this,e,r),this._notifySuccess(f,i),t&&this.webSocketClose(e,1e3,"Disconnect")},r.onClose=function(e,n){this._debug("Transport",this.getType(),"closed",e,n),g(e)&&(o=a&&s,c=null,u=null);var t=e.timeouts;for(var i in e.timeouts={},t)t.hasOwnProperty(i)&&this.clearTimeout(t[i]);var r=e.envelopes;for(var f in e.envelopes={},r)if(r.hasOwnProperty(f)){var d=r[f][0];r[f][1]&&(l=!1);var h={websocketCode:n.code,reason:n.reason};n.exception&&(h.exception=n.exception),this._notifyFailure(d.onFailure,e,d.messages,h)}},r.registered=function(e,n){i.registered(e,n),t=n},r.accept=function(e,n,i){return this._debug("Transport",this.getType(),"accept, supported:",o),o&&!!window.WebSocket&&!1!==t.websocketEnabled},r.send=function(e,n){this._debug("Transport",this.getType(),"sending",e,"/meta/connect =",n),m.call(this,u,e,n)},r.webSocketClose=function(e,n,t){try{e.webSocket&&e.webSocket.close(n,t)}catch(e){this._debug(e)}},r.abort=function(){i.abort(),d.call(this,u,{code:1e3,reason:"Abort"}),this.reset(!0)},r},s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],a=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:function(n){var t,s,a,u,c,l=new function(){var e=0,n={};this.register=function(t){var i=++e;return n[i]=t,i},this.unregister=function(e){var t=n[e];return delete n[e],t},this.setTimeout=function(e,n){return window.setTimeout(e,n)},this.clearTimeout=function(e){window.clearTimeout(e)}},f=this,d=n||"default",g=!1,h=new function(){var e=[],n={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(t,i,r){for(var o=[],s=0;s<e.length;++s){var a=e[s];!0===n[a].accept(t,i,r)&&o.push(a)}return o},this.negotiateTransport=function(t,i,r,o){for(var s=0;s<e.length;++s)for(var a=e[s],u=0;u<t.length;++u)if(a===t[u]){var c=n[a];if(!0===c.accept(i,r,o))return c}return null},this.add=function(t,i,r){for(var o=!1,s=0;s<e.length;++s)if(e[s]===t){o=!0;break}return o||("number"!=typeof r?e.push(t):e.splice(r,0,t),n[t]=i),!o},this.find=function(t){for(var i=0;i<e.length;++i)if(e[i]===t)return n[t];return null},this.remove=function(t){for(var i=0;i<e.length;++i)if(e[i]===t){e.splice(i,1);var r=n[t];return delete n[t],r}return null},this.clear=function(){e=[],n={}},this.reset=function(t){for(var i=0;i<e.length;++i)n[e[i]].reset(t)}},b="disconnected",p=0,v=null,m=0,_=[],y=!1,T=0,C={},S={},E=0,w=null,I=[],N={},O={},x={},k=!1,M=!1,L=0,A=0,R=null,D={useWorkerScheduler:!0,protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,maxSendBayeuxMessageSize:8192,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function U(e,n){try{return e[n]}catch(e){return}}function P(n){return e.isString(n)}function B(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function G(e){return e>="0"&&e<="9"}function F(e){switch(e){case" ":case"!":case"#":case"$":case"(":case")":case"*":case"+":case"-":case".":case"/":case"@":case"_":case"{":case"~":case"}":return!0;default:return!1}}function j(e){if(!P(e))return!1;if(e.length<2)return!1;if("/"!==e.charAt(0))return!1;for(var n=1;n<e.length;++n){var t=e.charAt(n);if(!(B(t)||G(t)||F(t)))return!1}return!0}function q(e){return void 0!==e&&null!==e&&"function"==typeof e}function H(e,n){for(var t="";--n>0&&!(e>=Math.pow(10,n));)t+="0";return t+=e}function W(e,n){if(window.console){var t=window.console[e];if(q(t)){var i=new Date;[].splice.call(n,0,0,H(i.getHours(),2)+":"+H(i.getMinutes(),2)+":"+H(i.getSeconds(),2)+"."+H(i.getMilliseconds(),3)),t.apply(window.console,n)}}}function z(e){return new RegExp("(^https?://)?(((\\[[^\\]]+])|([^:/?#]+))(:(\\d+))?)?([^?#]*)(.*)?").exec(e)}function V(e){f._debug("Configuring cometd object with",e),P(e)&&(e={url:e}),e||(e={}),D=f._mixin(!1,D,e);var n=f.getURL();if(!n)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var t=z(n),i=t[2],r=t[8],o=t[9];if(g=f._isCrossDomain(i),D.appendMessageTypeToURL)if(void 0!==o&&o.length>0)f._info("Appending message type to URI "+r+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),D.appendMessageTypeToURL=!1;else{var s=r.split("/"),a=s.length-1;r.match(/\/$/)&&(a-=1),s[a].indexOf(".")>=0&&(f._info("Appending message type to URI "+r+" is not supported, disabling 'appendMessageTypeToURL' configuration"),D.appendMessageTypeToURL=!1)}if(window.Worker&&window.Blob&&window.URL&&D.useWorkerScheduler){var u=function(){var e={};self.onmessage=function(n){var t=n.data,i=e[t.id];switch(t.type){case"setTimeout":e[t.id]=self.setTimeout(function(){delete e[t.id],self.postMessage({id:t.id})},t.delay);break;case"clearTimeout":delete e[t.id],i&&self.clearTimeout(i);break;default:throw"Unknown command "+t.type}}}.toString();u=u.substring(u.indexOf("{")+1,u.lastIndexOf("}"));var c=new window.Blob([u],{type:"application/json"}),d=window.URL.createObjectURL(c),h=new window.Worker(d);l.setTimeout=function(e,n){var t=l.register(e);return h.postMessage({id:t,type:"setTimeout",delay:n}),t},l.clearTimeout=function(e){l.unregister(e),h.postMessage({id:e,type:"clearTimeout"})},h.onmessage=function(e){var n=e.data.id,t=l.unregister(n);t&&t()}}}function Q(e){if(e){var n=C[e.channel];n&&n[e.id]&&(delete n[e.id],f._debug("Removed",e.listener?"listener":"subscription",e))}}function K(e){e&&!e.listener&&Q(e)}function Y(){for(var e in C)if(C.hasOwnProperty(e)){var n=C[e];if(n)for(var t in n)n.hasOwnProperty(t)&&K(n[t])}}function X(e){b!==e&&(f._debug("Status",b,"->",e),b=e)}function J(){return"disconnecting"===b||"disconnected"===b}function $(){return""+ ++p}function Z(e,n,t,i,r){try{return n.call(e,i)}catch(e){var o=f.onExtensionException;if(q(o)){f._debug("Invoking extension exception handler",t,e);try{o.call(f,e,t,r,i)}catch(e){f._info("Exception during execution of extension exception handler",t,e)}}else f._info("Exception during execution of extension",t,e);return i}}function ee(e){for(var n=I.length-1;n>=0&&void 0!==e&&null!==e;--n){var t=I[n],i=t.extension.outgoing;if(q(i)){var r=Z(t.extension,i,t.name,e,!0);e=void 0===r?e:r}}return e}function ne(e,n){var t=C[e];if(t)for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if(r)try{r.callback.call(r.scope,n)}catch(e){var o=f.onListenerException;if(q(o)){f._debug("Invoking listener exception handler",r,e);try{o.call(f,e,r,r.listener,n)}catch(e){f._info("Exception during execution of listener exception handler",r,e)}}else f._info("Exception during execution of listener",r,n,e)}}}function te(e,n){ne(e,n);for(var t=e.split("/"),i=t.length-1,r=i;r>0;--r){var o=t.slice(0,r).join("/")+"/*";r===i&&ne(o,n),ne(o+="*",n)}}function ie(){null!==w&&f.clearTimeout(w),w=null}function re(e,n){ie();var t=N.interval+n;f._debug("Function scheduled in",t,"ms, interval =",N.interval,"backoff =",E,e),w=f.setTimeout(e,t)}function oe(e,n,i){for(var r=0;r<e.length;++r){var o=e[r],s=o.id;v&&(o.clientId=v),void 0!==(o=ee(o))&&null!==o?(o.id=s,e[r]=o):(delete O[s],e.splice(r--,1))}if(0!==e.length){n&&(R=e[0]);var a=f.getURL();D.appendMessageTypeToURL&&(a.match(/\/$/)||(a+="/"),i&&(a+=i));var l={url:a,sync:!1,messages:e,onSuccess:function(e){try{u.call(f,e)}catch(e){f._info("Exception during handling of messages",e)}},onFailure:function(e,n,t){try{var i=f.getTransport();t.connectionType=i?i.getType():"unknown",c.call(f,e,n,t)}catch(e){f._info("Exception during handling of failure",e)}}};f._debug("Send",l),t.send(l,n)}}function se(e){m>0||!0===y?_.push(e):oe([e],!1)}function ae(){E=0}function ue(){var e=_;_=[],e.length>0&&oe(e,!1)}function ce(e){X("connecting"),re(function(){!function(){if(!J()){var e={id:$(),channel:"/meta/connect",connectionType:t.getType()};M||(e.advice={timeout:0}),X("connecting"),f._debug("Connect sent",e),oe([e],!0,"connect"),X("connected")}}()},e)}function le(e){e&&(N=f._mixin(!1,{},D.advice,e),f._debug("New advice",N))}function fe(e){if(ie(),e&&t&&t.abort(),g=!1,t=null,X("disconnected"),v=null,m=0,ae(),k=!1,M=!1,L=0,R=null,_.length>0){var n=_;_=[],c.call(f,void 0,n,{reason:"Disconnected"})}}function de(e,n,t){var i=f.onTransportException;if(q(i)){f._debug("Invoking transport exception handler",e,n,t);try{i.call(f,t,e,n)}catch(e){f._info("Exception during execution of transport exception handler",e)}}}function ge(e,n){q(e)&&(n=e,e=void 0),v=null,Y(),J()&&h.reset(!0),le({}),m=0,y=!0,s=e,a=n;var i=f.getURL(),r=h.findTransportTypes("1.0",g,i),o={id:$(),version:"1.0",minimumVersion:"1.0",channel:"/meta/handshake",supportedConnectionTypes:r,advice:{timeout:N.timeout,interval:N.interval}},u=f._mixin(!1,{},s,o);if(f._putCallback(u.id,n),!t&&!(t=h.negotiateTransport(r,"1.0",g,i))){var c="Could not find initial transport among: "+h.getTransportTypes();throw f._warn(c),c}f._debug("Initial transport is",t.getType()),X("handshaking"),f._debug("Handshake sent",u),oe([u],!1,"handshake")}function he(e,n){try{e.call(f,n)}catch(e){var t=f.onCallbackException;if(q(t)){f._debug("Invoking callback exception handler",e);try{t.call(f,e,n)}catch(e){f._info("Exception during execution of callback exception handler",e)}}else f._info("Exception during execution of message callback",e)}}function be(e){var n=f._getCallback([e.id]);q(n)&&(delete O[e.id],he(n,e))}function pe(e){var n=x[e.id];if(delete x[e.id],n){f._debug("Handling remote call response for",e,"with context",n);var t=n.timeout;t&&f.clearTimeout(t);var i=n.callback;if(q(i))return he(i,e),!0}return!1}function ve(e){f._debug("Transport failure handling",e),e.transport&&(t=e.transport),e.url&&t.setURL(e.url);var n=e.action,i=e.delay||0;switch(n){case"handshake":!function(e){X("handshaking"),y=!0,re(function(){ge(s,a)},e)}(i);break;case"retry":ce(i);break;case"none":fe(!0);break;default:throw"Unknown action "+n}}function me(e,n){be(e),te("/meta/handshake",e),te("/meta/unsuccessful",e),J()&&(n.action="none"),f.onTransportFailure.call(f,e,n,ve)}function _e(e){me(e,{cause:"failure",action:"handshake",transport:null})}function ye(e){return"disconnected"===b||!(!R||R.id!==e.id)&&(R=null,!0)}function Te(e,n){te("/meta/connect",e),te("/meta/unsuccessful",e),J()&&(n.action="none"),f.onTransportFailure.call(f,e,n,ve)}function Ce(e){ye(e)?(M=!1,Te(e,{cause:"failure",action:"retry",transport:null})):f._debug("Mismatched /meta/connect failure",e)}function Se(e){fe(!0),be(e),te("/meta/disconnect",e),te("/meta/unsuccessful",e)}function Ee(e){Se(e)}function we(e){var n=C[e.subscription];if(n)for(var t in n)if(n.hasOwnProperty(t)){var i=n[t];i&&!i.listener&&(delete n[t],f._debug("Removed failed subscription",i))}be(e),te("/meta/subscribe",e),te("/meta/unsuccessful",e)}function Ie(e){we(e)}function Ne(e){be(e),te("/meta/unsubscribe",e),te("/meta/unsuccessful",e)}function Oe(e){Ne(e)}function xe(e){pe(e)||(be(e),te("/meta/publish",e),te("/meta/unsuccessful",e))}function ke(e){xe(e)}function Me(e){if(L=0,void 0!==(e=function(e){for(var n=0;n<I.length&&void 0!==e&&null!==e;++n){var t=I[n],i=t.extension.incoming;if(q(i)){var r=Z(t.extension,i,t.name,e,!1);e=void 0===r?e:r}}return e}(e))&&null!==e)switch(le(e.advice),e.channel){case"/meta/handshake":!function(e){var n=f.getURL();if(e.successful){var i=f._isCrossDomain(z(n)[2]),r=h.negotiateTransport(e.supportedConnectionTypes,e.version,i,n);if(null===r)return e.successful=!1,void me(e,{cause:"negotiation",action:"none",transport:null});t!==r&&(f._debug("Transport",t.getType(),"->",r.getType()),t=r),v=e.clientId,y=!1,ue(),e.reestablish=k,k=!0,be(e),te("/meta/handshake",e),A=e["x-messages"]||0;var o=J()?"none":N.reconnect||"retry";switch(o){case"retry":ae(),0===A?ce(0):f._debug("Processing",A,"handshake-delivered messages");break;case"none":fe(!0);break;default:throw"Unrecognized advice action "+o}}else me(e,{cause:"unsuccessful",action:N.reconnect||"handshake",transport:t})}(e);break;case"/meta/connect":!function(e){if(ye(e))if(M=e.successful){te("/meta/connect",e);var n=J()?"none":N.reconnect||"retry";switch(n){case"retry":ae(),ce(E);break;case"none":fe(!1);break;default:throw"Unrecognized advice action "+n}}else Te(e,{cause:"unsuccessful",action:N.reconnect||"retry",transport:t});else f._debug("Mismatched /meta/connect reply",e)}(e);break;case"/meta/disconnect":!function(e){e.successful?(fe(!1),be(e),te("/meta/disconnect",e)):Se(e)}(e);break;case"/meta/subscribe":!function(e){e.successful?(be(e),te("/meta/subscribe",e)):we(e)}(e);break;case"/meta/unsubscribe":!function(e){e.successful?(be(e),te("/meta/unsubscribe",e)):Ne(e)}(e);break;default:!function(e){void 0!==e.data?pe(e)||(te(e.channel,e),A>0&&0==--A&&(f._debug("Processed last handshake-delivered message"),ce(0))):void 0===e.successful?f._warn("Unknown Bayeux Message",e):e.successful?(be(e),te("/meta/publish",e)):xe(e)}(e)}}function Le(e){var n=C[e];if(n)for(var t in n)if(n.hasOwnProperty(t)&&n[t])return!0;return!1}function Ae(e,n){var t={scope:e,method:n};if(q(e))t.scope=void 0,t.method=e;else if(P(n)){if(!e)throw"Invalid scope "+e;if(t.method=e[n],!q(t.method))throw"Invalid callback "+n+" for scope "+e}else if(!q(n))throw"Invalid callback "+n;return t}function Re(e,n,t,i){var r=Ae(n,t);f._debug("Adding",i?"listener":"subscription","on",e,"with scope",r.scope,"and callback",r.method);var o=++T,s={id:o,channel:e,scope:r.scope,callback:r.method,listener:i},a=C[e];return a||(a={},C[e]=a),a[o]=s,f._debug("Added",i?"listener":"subscription",s),s}this._mixin=function(e,n,t){for(var i=n||{},r=2;r<arguments.length;++r){var o=arguments[r];if(void 0!==o&&null!==o)for(var s in o)if(o.hasOwnProperty(s)){var a=U(o,s),u=U(i,s);if(a===n)continue;if(void 0===a)continue;if(e&&"object"==typeof a&&null!==a)if(a instanceof Array)i[s]=this._mixin(e,u instanceof Array?u:[],a);else{var c="object"!=typeof u||u instanceof Array?{}:u;i[s]=this._mixin(e,c,a)}else i[s]=a}}return i},this._warn=function(){W("warn",arguments)},this._info=function(){"warn"!==D.logLevel&&W("info",arguments)},this._debug=function(){"debug"===D.logLevel&&W("debug",arguments)},this._isCrossDomain=function(e){return!!(window.location&&window.location.host&&e)&&e!==window.location.host},this.send=se,this._getCallback=function(e){return O[e]},this._putCallback=function(e,n){var t=this._getCallback(e);return q(n)&&(O[e]=n),t},this.onTransportFailure=function(e,n,i){this._debug("Transport failure",n,"for",e);var r=this.getTransportRegistry(),o=this.getURL(),s=this._isCrossDomain(z(o)[2]),a=r.findTransportTypes("1.0",s,o);if("none"===n.action){if("/meta/handshake"===e.channel&&!n.transport){var u="Could not negotiate transport, client=["+a+"], server=["+e.supportedConnectionTypes+"]";this._warn(u),de(t.getType(),null,{reason:u,connectionType:t.getType(),transport:t})}}else if(n.delay=this.getBackoffPeriod(),"/meta/handshake"===e.channel){if(!n.transport){var c=t?t.getType():null,l=r.negotiateTransport(a,"1.0",s,o);if(l){var d=l.getType();this._debug("Transport",c,"->",d),de(c,d,e.failure),n.action="handshake",n.transport=l}else this._warn("Could not negotiate transport, client=["+a+"]"),de(c,null,e.failure),n.action="none"}"none"!==n.action&&this.increaseBackoffPeriod()}else{var g=(new Date).getTime();if(0===L&&(L=g),"retry"===n.action){n.delay=this.increaseBackoffPeriod();var h=N.maxInterval;if(h>0){var b=N.timeout+N.interval+h;g-L+E>b&&(n.action="handshake")}}"handshake"===n.action&&(n.delay=0,r.reset(!1),this.resetBackoffPeriod())}i.call(f,n)},this.receive=Me,u=function(e){f._debug("Received",e);for(var n=0;n<e.length;++n)Me(e[n])},c=function(e,n,t){f._debug("handleFailure",e,n,t),t.transport=e;for(var i=0;i<n.length;++i){var r=n[i],o={id:r.id,successful:!1,channel:r.channel,failure:t};switch(t.message=r,r.channel){case"/meta/handshake":_e(o);break;case"/meta/connect":Ce(o);break;case"/meta/disconnect":Ee(o);break;case"/meta/subscribe":o.subscription=r.subscription,Ie(o);break;case"/meta/unsubscribe":o.subscription=r.subscription,Oe(o);break;default:ke(o)}}},this.registerTransport=function(e,n,t){var i=h.add(e,n,t);return i&&(this._debug("Registered transport",e),q(n.registered)&&n.registered(e,this)),i},this.unregisterTransport=function(e){var n=h.remove(e);return null!==n&&(this._debug("Unregistered transport",e),q(n.unregistered)&&n.unregistered()),n},this.unregisterTransports=function(){h.clear()},this.getTransportTypes=function(){return h.getTransportTypes()},this.findTransport=function(e){return h.find(e)},this.getTransportRegistry=function(){return h},this.configure=function(e){V.call(this,e)},this.init=function(e,n){this.configure(e),this.handshake(n)},this.handshake=function(e,n){if("disconnected"!==b)throw"Illegal state: handshaken";ge(e,n)},this.disconnect=function(e,n){if(!J()){q(e)&&(n=e,e=void 0);var t={id:$(),channel:"/meta/disconnect"},i=this._mixin(!1,{},e,t);f._putCallback(i.id,n),X("disconnecting"),oe([i],!1,"disconnect")}},this.startBatch=function(){!function(){++m,f._debug("Starting batch, depth",m)}()},this.endBatch=function(){!function(){if(--m,f._debug("Ending batch, depth",m),m<0)throw"Calls to startBatch() and endBatch() are not paired";0!==m||J()||y||ue()}()},this.batch=function(e,n){var t=Ae(e,n);this.startBatch();try{t.method.call(t.scope),this.endBatch()}catch(e){throw this._info("Exception during execution of batch",e),this.endBatch(),e}},this.addTransportListener=function(e,n){if("timeout"!==e)throw"Unsupported event "+e;var t=S[e];t||(S[e]=t=[]),t.push(n)},this.removeTransportListener=function(e,n){var t=S[e];if(t){var i=t.indexOf(n);if(i>=0)return t.splice(i,1),!0}return!1},this._getTransportListeners=function(e){return S[e]},this.addListener=function(e,n,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!P(e))throw"Illegal argument type: channel must be a string";return Re(e,n,t,!0)},this.removeListener=function(e){if(!(e&&e.channel&&"id"in e))throw"Invalid argument: expected subscription, not "+e;Q(e)},this.clearListeners=function(){C={}},this.subscribe=function(e,n,t,i,r){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!j(e))throw"Illegal argument: invalid channel "+e;if(J())throw"Illegal state: disconnected";q(n)&&(r=i,i=t,t=n,n=void 0),q(i)&&(r=i,i=void 0);var o=!Le(e),s=Re(e,n,t,!1);if(o){var a={id:$(),channel:"/meta/subscribe",subscription:e},u=this._mixin(!1,{},i,a);f._putCallback(u.id,r),se(u)}else q(r)&&f.setTimeout(function(){he(r,{id:$(),successful:!0,channel:"/meta/subscribe",subscription:e})},0);return s},this.unsubscribe=function(e,n,t){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(J())throw"Illegal state: disconnected";q(n)&&(t=n,n=void 0),this.removeListener(e);var i=e.channel;if(Le(i))q(t)&&f.setTimeout(function(){he(t,{id:$(),successful:!0,channel:"/meta/unsubscribe",subscription:i})},0);else{var r={id:$(),channel:"/meta/unsubscribe",subscription:i},o=this._mixin(!1,{},n,r);f._putCallback(o.id,t),se(o)}},this.resubscribe=function(e,n){if(K(e),e)return this.subscribe(e.channel,e.scope,e.callback,n)},this.clearSubscriptions=function(){Y()},this.publish=function(e,n,t,i){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!j(e))throw"Illegal argument: invalid channel "+e;if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(J())throw"Illegal state: disconnected";q(n)?(i=n,n={},t=void 0):q(t)&&(i=t,t=void 0);var r={id:$(),channel:e,data:n},o=this._mixin(!1,{},t,r);f._putCallback(o.id,i),se(o)},this.publishBinary=function(e,n,t,i,r,o){q(n)?(o=n,n=new ArrayBuffer(0),t=!0,i=void 0,r=void 0):q(t)?(o=t,t=!0,i=void 0,r=void 0):q(i)?(o=i,i=void 0,r=void 0):q(r)&&(o=r,r=void 0);var s={meta:i,data:n,last:t},a=this._mixin(!1,r,{ext:{binary:{}}});this.publish(e,s,a,o)},this.remoteCall=function(e,n,t,i,r){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!P(e))throw"Illegal argument type: target must be a string";if(J())throw"Illegal state: disconnected";if(q(n)?(r=n,n={},t=D.maxNetworkDelay,i=void 0):q(t)?(r=t,t=D.maxNetworkDelay,i=void 0):q(i)&&(r=i,i=void 0),"number"!=typeof t)throw"Illegal argument type: timeout must be a number";e.match(/^\//)||(e="/"+e);var o="/service"+e;if(!j(o))throw"Illegal argument: invalid target "+e;var s={id:$(),channel:o,data:n},a=this._mixin(!1,{},i,s),u={callback:r};t>0&&(u.timeout=f.setTimeout(function(){f._debug("Timing out remote call",a,"after",t,"ms"),xe({id:a.id,error:"406::timeout",successful:!1,failure:{message:a,reason:"Remote Call Timeout"}})},t),f._debug("Scheduled remote call timeout",a,"in",t,"ms")),x[a.id]=u,se(a)},this.remoteCallBinary=function(e,n,t,i,r,o,s){q(n)?(s=n,n=new ArrayBuffer(0),t=!0,i=void 0,r=D.maxNetworkDelay,o=void 0):q(t)?(s=t,t=!0,i=void 0,r=D.maxNetworkDelay,o=void 0):q(i)?(s=i,i=void 0,r=D.maxNetworkDelay,o=void 0):q(r)?(s=r,r=D.maxNetworkDelay,o=void 0):q(o)&&(s=o,o=void 0);var a={meta:i,data:n,last:t},u=this._mixin(!1,o,{ext:{binary:{}}});this.remoteCall(e,a,r,u,s)},this.getStatus=function(){return b},this.isDisconnected=J,this.setBackoffIncrement=function(e){D.backoffIncrement=e},this.getBackoffIncrement=function(){return D.backoffIncrement},this.getBackoffPeriod=function(){return E},this.increaseBackoffPeriod=function(){return function(){return E<D.maxBackoff&&(E+=D.backoffIncrement),E}()},this.resetBackoffPeriod=function(){ae()},this.setLogLevel=function(e){D.logLevel=e},this.registerExtension=function(e,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!P(e))throw"Illegal argument type: extension name must be a string";for(var t=!1,i=0;i<I.length;++i)if(I[i].name===e){t=!0;break}return t?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(I.push({name:e,extension:n}),this._debug("Registered extension",e),q(n.registered)&&n.registered(e,this),!0)},this.unregisterExtension=function(e){if(!P(e))throw"Illegal argument type: extension name must be a string";for(var n=!1,t=0;t<I.length;++t){var i=I[t];if(i.name===e){I.splice(t,1),n=!0,this._debug("Unregistered extension",e);var r=i.extension;q(r.unregistered)&&r.unregistered();break}}return n},this.getExtension=function(e){for(var n=0;n<I.length;++n){var t=I[n];if(t.name===e)return t.extension}return null},this.getName=function(){return d},this.getClientId=function(){return v},this.getURL=function(){if(t){var e=t.getURL();if(e)return e;if(e=D.urls[t.getType()])return e}return D.url},this.getTransport=function(){return t},this.getConfiguration=function(){return this._mixin(!0,{},D)},this.getAdvice=function(){return this._mixin(!0,{},N)},this.setTimeout=function(e,n){return l.setTimeout(function(){try{f._debug("Invoking timed function",e),e()}catch(n){f._debug("Exception invoking timed function",e,n)}},n)},this.clearTimeout=function(e){l.clearTimeout(e)},window.WebSocket&&this.registerTransport("websocket",new o),this.registerTransport("long-polling",new i),this.registerTransport("callback-polling",new r)},Transport:n,RequestTransport:t,LongPollingTransport:i,CallbackPollingTransport:r,WebSocketTransport:o,Utils:e,Z85:{encode:function(e){var n=null;if(e instanceof ArrayBuffer?n=e:e.buffer instanceof ArrayBuffer?n=e.buffer:Array.isArray(e)&&(n=new Uint8Array(e).buffer),null==n)throw"Cannot Z85 encode "+e;for(var t=n.byteLength,i=t%4,r=4-(0===i?4:i),o=new DataView(n),a="",u=0,c=0;c<t+r;++c){var l=c>=t;if(u=256*u+(l?0:o.getUint8(c)),(c+1)%4==0){for(var f=52200625,d=5;d>0;--d){if(!l||d>r){var g=Math.floor(u/f)%85;a+=s[g]}f/=85}u=0}}return a},decode:function(e){for(var n=e.length%5,t=5-(0===n?5:n),i=0;i<t;++i)e+=s[s.length-1];for(var r=e.length,o=new ArrayBuffer(4*r/5-t),u=new DataView(o),c=0,l=0,f=0,d=0;d<r;++d){var g=e.charCodeAt(l++)-32;if(c=85*c+a[g],l%5==0){for(var h=16777216;h>=1;)f<u.byteLength&&u.setUint8(f++,Math.floor(c/h)%256),h/=256;c=0}}return o}}}})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0));var r=function(){var e=new i.default("amb.GraphQLSubscriptionExtension"),n={};this.isGraphQLChannel=function(e){return e&&e.startsWith("/rw/graphql")},this.addGraphQLChannel=function(e,t){n[e]=t},this.removeGraphQLChannel=function(e){delete n[e]},this.getGraphQLSubscriptions=function(){return n},this.outgoing=function(t){return"/meta/subscribe"===t.channel&&this.isGraphQLChannel(t.subscription)&&(t.ext||(t.ext={}),n[t.subscription]&&(e.debug("Subscribing with GraphQL subscription:"+n[t.subscription]),t.ext.serializedGraphQLSubscription=n[t.subscription])),t}};n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0));var r=function(){var e=new i.default("amb.SessionExtension"),n=!1;this.extendSession=function(){n=!0},this.outgoing=function(t){return"/meta/connect"===t.channel&&n&&(t.ext||(t.ext={}),e.debug("extendSession"),t.ext.extendSession=!0,n=!1),t}};n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(0)),r=o(t(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=new i.default("amb.TokenManagementExtension"),n="/meta/subscribe",t="/meta/unsubscribe",o="/meta/handshake",s=r.default.subscribeCommandsFlow.maxInflight,a=[];function u(e){return e.channel==n||e.channel==t}function c(){e.debug("notifyOnAvailabilityOfToken - current tokenCount: "+s);try{a.forEach(function(e){e()})}catch(n){e.addErrorMessage("notifyOnAvailabilityOfToken - failed to call tokenEventListeners. Error Details : "+n)}}this.updateTokenCount=function(e){s=e},this.refillTokens=function(){s=r.default.subscribeCommandsFlow.maxInflight,c(),e.debug("refillTokens -- tokenCount : "+s)},this.outgoing=function(e){return function(e){return e.channel===o}(e)&&(e.ext||(e.ext={}),e.ext.supportsSubscribeCommandFlow=!0),r.default.subscribeCommandsFlow.enable?(u(e)&&s>0&&s--,e):e},this.incoming=function(e){return r.default.subscribeCommandsFlow.enable?(u(e)?(s<r.default.subscribeCommandsFlow.maxInflight&&s++,c()):function(e){if(!e.ext)return!1;var n=e.ext.received_by_glide;return!!n&&n&&u(n)}(e)&&(e=null),e):e},this.getTokenCount=function(){return s},this.addTokenAvailabilityListener=function(n){n&&(e.debug("addTokenAvailabilityListener - tokenEventListener : "+n),a.push(n))},this.removeTokenAvailabilityListener=function(n){if(n){e.debug("removeTokenAvailabilityListener - tokenEventListener : "+n);var t=a.findIndex(function(e){return n===e});-1!==t&&(e.debug("removeTokenAvailabilityListener - removing listener at index : "+t),a.splice(t,1))}}};n.default=s},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0)),r=t(2),o=["callback"];function s(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var a=function(){var e=new i.default("amb.CancelTransactionSender"),n={},t=new Map,a=null,u=!1;function c(e,n){var t={};return t.request=e,t.request.action=r.CANCEL_TRANSACTION_ACTION,t.response=n,t}function l(e,n){t.has(e)&&(t.get(e)(n),t.delete(e))}function f(n){var t;n?n.data&&n.ext&&n.ext.status?n.ext.status!==r.REQUEST_ACCEPTED?n.ext.status!==r.REQUEST_SUCCESS||(null===(t=n.ext.result)||void 0===t?void 0:t.length)===n.data.length?n.data.forEach(function(e,t){if(e.hasOwnProperty("nowUiInteraction")){var i=c(e,n.ext.status===r.REQUEST_SUCCESS?n.ext.result[t]:n.ext);l(e.nowUiInteraction,i)}}):e.addWarnMessage("Invalid response for cancel request"):e.debug("Batch Cancel Request accepted"):e.addWarnMessage("Invalid response for cancel request"):e.addWarnMessage("Empty response for cancel request")}return n.cancelTransaction=function(n,i){if(e.debug("cancelTransaction"),u||function(e){(a=e.getChannel(r.CANCEL_TRANSACTION_CHANNEL)).subscribe(f),u=!0}(i),n&&0!==n.length){var d=[];if(n.forEach(function(n){var i=function(n){var i={isValid:!0,error:null};return n?n.hasOwnProperty("nowUiInteraction")&&"string"==typeof n.nowUiInteraction?t.has(n.nowUiInteraction)?(e.debug("Transaction has already been submitted for cancellation. nowUiInteraction: "+n.nowUiInteraction),i.isValid=!1,i.error=r.TRANSACTION_ALREADY_SUBMITTED,i):i:(e.debug("nowUiInteraction is unavailable or invalid"),i.isValid=!1,i.error=r.MISSING_INTERACTION_ID,i):(e.debug("empty cancel request"),i.isValid=!1,i.error=r.MISSING_REQUEST_DATA,i)}(n);if(i.isValid){var a=n.nowUiInteraction,u=n.callback;d.push({nowUiInteraction:a}),u&&t.set(n.nowUiInteraction,u)}else!function(e,n){null!==e&&void 0!==e&&e.callback&&(0,e.callback)(c(s(e,o),{successful:!1,status:n}))}(n,i.error)}),0!==d.length)for(var g=function(e){var n=d.slice(e,e+10);a.publish(n,function(e){return function(e,n){if(!n.successful){var t={successful:!1,status:r.PUBLISH_FAILURE};e.forEach(function(e){l(e.nowUiInteraction,c(e,t))})}}(n,e)})},h=0;h<d.length;h+=10)g(h);else e.debug("All requests filtered due to invalid inputs")}else e.addWarnMessage("Request array is empty or not defined")},n};n.default=a},function(e,n,t){!function(n,i){e.exports=i(t(11))}(0,function(e){return function(){var n=e,t=n.lib.WordArray;n.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<t;o+=3)for(var s=(n[o>>>2]>>>24-o%4*8&255)<<16|(n[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|n[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<t;a++)r.push(i.charAt(s>>>6*(3-a)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var n=e.length,i=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<i.length;o++)r[i.charCodeAt(o)]=o}var s=i.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(n=a)}return function(e,n,i){for(var r=[],o=0,s=0;s<n;s++)if(s%4){var a=i[e.charCodeAt(s-1)]<<s%4*2,u=i[e.charCodeAt(s)]>>>6-s%4*2,c=a|u;r[o>>>2]|=c<<24-o%4*8,o++}return t.create(r,o)}(e,n,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64})},function(e,n){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,n){},function(e,n,t){!function(n,i){e.exports=i(t(11))}(0,function(e){return e.enc.Utf8})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0)),r=t(2);function o(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return s(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var a=function(){var e,n,t=new i.default("amb.MessagesRedeliveryManager"),s=[],a=[],u=function(e){return e.ext.redelivery_message},c=function(e){return!0!==e.ext.redelivery_message.redelivery_not_authorized},l=function(e,n){return e.find(function(e){return function(e,n){return e.ext[r.MSG_SHARD]===n.ext[r.MSG_SHARD]&&e.ext[r.MSG_NUM]===n.ext[r.MSG_NUM]}(e,n)})},f=function(e){return r.MSG_NUM+":"+e.ext[r.MSG_NUM]+","+r.MSG_SHARD+":"+e.ext[r.MSG_SHARD]};function d(){t.debug("Clearing all messages"),s=[],a=[]}return{resetState:function(){d(),e=!0,n=!1},containsMetaInfo:function(e){return e.ext&&e.ext[r.MSG_NUM]&&e.ext[r.MSG_SHARD]},shouldDeliver:function(i){return e?function(e){return e.ext.redelivery_notification&&!1===e.ext.redelivery_notification.can_redeliver}(i)?(t.debug("No messages to redeliver"),e=!1,!1):!!this.containsMetaInfo(i)&&(u(i)&&c(i)?(t.debug("Processing redelivered - "+f(i)),s.push(i)):u(i)&&!c(i)?t.debug("Not Processing unauthorized redelivery message - "+f(i)):(a.push(i),t.debug("Processing original - "+f(i))),function(e){return u(e)&&!0===e.ext.redelivery_message.is_last_redelivery}(i)&&function(){t.debug("Redelivery over"),e=!1,n=!0}(),!1):l(s,i)?(t.debug("Dropping duplicate: "+f(i)),!1):(t.debug("Out of redelivery. New message received: "+f(i)),d(),!0)},shouldDeliverPendingMessages:function(){return n},getAllPendingMessages:function(){var e=[];if(function(){return s.length>0||a.length>0}()){var i=function(e,n){return n.filter(function(n){return!l(e,n)})}(s,a);e=s.concat(i)}return t.debug("Flushing: "+function(e){var n,t="",i=o(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;t=t.concat("<"+f(r)+">")}}catch(e){i.e(e)}finally{i.f()}return t}(e)),s=e,a=[],n=!1,e},getMissedMessagesSize:function(){return s.length},getOriginalMessagesSize:function(){return a.length}}};n.default=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(t(0));function r(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var s=function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(){var n=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"emit",function(e,n){window.localStorage.setItem(e,JSON.stringify(n)),window.localStorage.removeItem(e)}),o(this,"on",function(e,t){if(n.registeredListeners.has(e)){var i=n.registeredListeners.get(e);window.removeEventListener("storage",i),n.LOGGER.debug("Removed storage event listener "+e)}var r=function(n){var i=n.key,r=n.newValue;i===e&&r&&t(JSON.parse(r))};window.addEventListener("storage",r),n.LOGGER.debug("Registered storage event listener "+e),n.registeredListeners.set(e,r)}),this.registeredListeners=new Map,this.LOGGER=new i.default("amb.CrossClientChannel")});n.default=s},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:134217727,n=[],t=Math.max(1,Math.floor(e));return{enqueue:function(e){return this.getAvailableSpace()>0&&(n.push(e),!0)},enqueueMultiple:function(e){return this.getAvailableSpace()>=e.length&&(n=n.concat(e),!0)},dequeue:function(){var e;return n.length>0&&(e=n.shift()),e},dequeueMultiple:function(e){var t;return e>=0&&n.length>=e&&(t=[],e>0&&(t=n.slice(0,e),n=n.slice(e))),t},clear:function(){n=[]},getSize:function(){return n.length},getCapacity:function(){return t},getAvailableSpace:function(){return t-n.length},getQueueBuffer:function(){return n}}};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t(1)),r=t(4),o=s(t(0));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,n){var t={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe"},s=202,a=429,u=3e5,c=new o.default("amb.SubscriptionCommandSender");!function(){n.addTokenAvailabilityListener(function(){C()})}();var l=!i.default.subscribeCommandsFlow.enable,f=null;function d(e,n,t){return Math.min(t,Math.max(n,e))}function g(){return n.getTokenCount()>=i.default.subscribeCommandsFlow.maxInflight}function h(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e||(0,r.isNil)(f)){var t=d(i.default.subscribeCommandsFlow.maxWait,0,u);c.debug("restartTimer - force: "+e+", timerObject : "+f+", timeInterval : "+t),b(),f=setTimeout(function(){!function(){f=null,c.debug("onTimer - stopping : "+l),l||(n.refillTokens(),C())}()},t)}}function b(){(0,r.isNil)(f)||(c.debug("stopTimer"),clearTimeout(f),f=null)}function p(){var e=parseInt(i.default.subscribeCommandsFlow.retryDelay.min);return e=d(e,0,u)}function v(e,n,o,s){var a;c.debug("scheduleRetry - channel : "+e.getName()+", triesLeft : "+n+", mode : "+o);var u=function(e){return d(i.default.subscribeCommandsFlow.retryDelay.increaseFactor*e,i.default.subscribeCommandsFlow.retryDelay.min,i.default.subscribeCommandsFlow.retryDelay.max)}(s);switch(o){case t.SUBSCRIBE:a=function(){return y(e,n,u)};break;case t.UNSUBSCRIBE:a=function(){return T(e,n,u)}}(0,r.isNil)(a)||setTimeout(a,s)}function m(e,t,i,r,o){c.debug("onResponse - response ".concat(JSON.stringify(e),", channel ").concat(JSON.stringify(t),", mode : ").concat(i,", \n\t\t\ttriesLeft ").concat(r,", stopping : ").concat(l,", tokenCount : ").concat(n.getTokenCount(),", isBucketFull - ").concat(g(),", retryDelay - ").concat(o)),l?t.subscriptionCallback(e):(r-=1,g()&&b(),r>0&&function(e){if(c.debug("isRetriable - response : "+e),e&&e.ext){var n=e.ext.rejected_by_glide;if(n){var t=parseInt(e.ext["glide.amb.reply.status.code"]);if(c.addWarnMessage("isRetriable - rejected_by_glide : "+n+", glide.amb.reply.status.code : "+t),!isNaN(t))return t==a||t==s}}return c.debug("isRetriable -  "+!1),!1}(e)?v(t,r,i,o):t.subscriptionCallback(e),C())}function _(n){return c.debug("addItemToQueue - item : "+n),!!e.enqueue(n)&&(C(),!0)}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p();return c.debug("enqueueSubscribe - channel: "+e.getName()+", triesLeft : "+n+", stopping : "+l+", retryDelay : "+o),!!(!l&&(0,r.isObject)(e)&&((0,r.isNil)(n)&&(n=1+Math.floor(i.default.subscribeCommandsFlow.retries)),n>0))&&_(function(){c.debug("enqueueSubscribe - inside the item execution. Calling channel._subscribeToCometD - channel: "+e.getName()+", triesLeft : "+n),e._subscribeToCometD(function(i){return m(i,e,t.SUBSCRIBE,n,o)})})}function T(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p();return c.debug("enqueueUnsubscribe - channel: "+e.getName()+", triesLeft : "+n+", stopping : "+l+", retryDelay : "+o),!!(!l&&(0,r.isObject)(e)&&((0,r.isNil)(n)&&(n=1+Math.floor(i.default.subscribeCommandsFlow.retries)),n>0))&&_(function(){e._unsubscribeFromCometD(function(i){return m(i,e,t.UNSUBSCRIBE,n,o)})})}function C(){var t=Math.min(e.getSize(),function(){return d(n.getTokenCount(),0,i.default.subscribeCommandsFlow.maxInflight)}());c.debug("processQueue - numberToProcess : "+t),t>0&&(e.dequeueMultiple(t).forEach(function(e){return(0,r.isNil)(e)||e()}),h(!1))}return{subscribeToChannel:function(e){return c.debug("subscribeToChannel - to : "+e.getName()),y(e)},unsubscribeToChannel:function(e){return c.debug("unsubscribeToChannel - from : "+e.getName()),T(e)},stop:function(){c.debug("stop"),function(){c.debug("signalStop - stopping : "+l),l||(l=!0,b(),e.clear())}()},isStopping:function(){return l},getQueue:function(){return e},isBucketEmpty:function(){return!g()},getTimerObject:function(){return f},getTokenCountFromTokenManager:function(){return n.getTokenCount()}}};n.default=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(0)),r=o(t(1));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==t.return||t.return()}finally{if(u)throw o}}}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var u=function(e){var n={},t=new i.default("amb.TransportManagement");return n.isPruningEnabled=function(){return"false"!==r.default.pruneFailedTransports},n.processConnectionOpened=function(){this.isPruningEnabled()&&(t.debug("Processing connection opened"),this.removeSkippedTransportsInConnect())},n.removeSkippedTransportsInConnect=function(){var n=null===e.getTransport()?null:e.getTransport().getType();if(t.addInfoMessage("Connected using transport "+n),t.debug("Purging failed transports from registry..."),null!==n){var i,r=[],o=s(e.getTransportTypes());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a==n)break;e.unregisterTransport(a),r.push(a)}}catch(e){o.e(e)}finally{o.f()}t.addInfoMessage("Removed failed registry transports after connect: {"+r+"}")}},n};n.default=u}]);
/*! RESOURCE: /scripts/glide_amb_get_client.js */
amb.getClient();
;
;
/*! RESOURCE: /scripts/js_includes_amb.js */
